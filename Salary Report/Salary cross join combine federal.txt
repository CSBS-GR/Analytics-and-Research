create table TMP_SALARY_REPORT_14N15_Final as
SELECT 
AA.*
,BB.DISTRICT_ID
,BB.N_INCUMBENT
,BB.AVG_ACTUAL_SALARY
,BB.MAX_ACTUAL_SALARY
,BB.MAX_BASE_RANGE
,BB.MID_BASE_RANGE
,BB.MIN_ACTUAL_SALARY
,BB.MIN_BASE_RANGE
from (
SELECT * FROM 
(SELECT DISTINCT ACCOUNT_ID,Account FROM F_SALARY_REPORT_COMBI ORDER BY ACCOUNT_ID) A
CROSS JOIN
(SELECT DISTINCT year FROM F_SALARY_REPORT_COMBI ORDER BY year) B
CROSS JOIN 
(SELECT DISTINCT TITLE_ID,Position FROM F_SALARY_REPORT_COMBI ORDER BY TITLE_ID) C
ORDER BY YEAR, ACCOUNT_ID, TITLE_ID) AA
LEFT JOIN F_SALARY_REPORT_COMBI BB ON (AA.ACCOUNT_ID = BB.ACCOUNT_ID AND
    AA.YEAR=BB.YEAR AND AA.TITLE_ID = BB.TITLE_ID)
ORDER BY aa.YEAR, aa.ACCOUNT_ID, aa.TITLE_ID

drop table F_SALARY_REPORT_14N15_Final;
create table F_SALARY_REPORT_14N15_Final as
SELECT b.ACCOUNT_ID,
  b.ACCOUNT,
  b.DISTRICT_ID,
  b.N_INCUMBENT,
  b.TITLE_ID,
  b.POSITION,
  b.YEAR,
  b.AVG_ACTUAL_SALARY,
  b.MAX_ACTUAL_SALARY,
  b.MAX_BASE_RANGE,
  b.MID_BASE_RANGE,
  b.MIN_ACTUAL_SALARY,
  b.MIN_BASE_RANGE,
a.N_Fed_Incumbent
a.Avg,
a.Max,
a.Min
from TMP_SALARY_REPORT_14N15_FINAL b 
left join 
(select state,EQUIVALENT_ACCOUNT,position, count(ID) as N_Fed_Incumbent,avg(salary)/1000 as Avg, max(salary)/1000 as Max, min(salary)/1000 as Min
from TMP_FEDERAL_SALARY 
group by state,EQUIVALENT_ACCOUNT, position
order by state asc ) a
on b.Account = a.EQUIVALENT_ACCOUNT and b.POSITION = a.POSITION
order by b.YEAR, b.ACCOUNT asc

